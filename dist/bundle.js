(()=>{"use strict";const e={inputType:".add__type",inputDescription:".add__description",inputValue:".add__value",inputBtn:".add__btn",incomeContainer:".income__list",expensesContainer:".expenses__list",budgetLabel:".budget__value",incomeLabel:".budget__income--value",expensesLabel:".budget__expenses--value",percentageLabel:".budget__expenses--percentage",container:".container",expensesPercentageLabel:".item__percentage",dateLabel:".budget__title--month"},t=(e,t)=>{let a,n,l;return a=(e=(e=Math.abs(e)).toFixed(2)).split("."),n=a[0],n.length>3&&n.length<7?n=n.substr(0,n.length-3)+","+n.substr(n.length-3,3):n.length>6&&(n=n.substr(0,n.length-6)+","+n.substr(n.length-6,3)+","+n.substr(n.length-3,3)),l=a[1],("exp"===t?"-":"+")+" "+n+"."+l},a=(e,t)=>{for(let a=0;a<e.length;a++)t(e[a],a)},n=a=>{let n;n=a.budget>0?"inc":"exp",document.querySelector(e.budgetLabel).textContent=t(a.budget,n),document.querySelector(e.incomeLabel).textContent=t(a.totalInc,"inc"),document.querySelector(e.expensesLabel).textContent=t(a.totalExp,"exp"),a.percentage>0?document.querySelector(e.percentageLabel).textContent=`${a.percentage}%`:document.querySelector(e.percentageLabel).textContent="---"},l=()=>{let t=document.querySelectorAll(e.inputType+","+e.inputDescription+","+e.inputValue);a(t,(function(e){e.classList.toggle("red-focus")})),document.querySelector(e.inputBtn).classList.toggle("red")},i=new class{constructor(e,t,a){this.id=e,this.description=t,this.value=a,this.percentage=-1,this.data={allItems:{exp:[],inc:[]},totals:{exp:0,inc:0},budget:0,percentage:-1}}calcPercentage(e,t,a){this.data.allItems.exp[a].percentage=e>0?Math.round(t/e*100):-1}getPercentage(e){return this.data.allItems.exp[e].percentage}calculateTotal(e){let t=0;this.data.allItems[e].forEach((function(e){t+=e.value})),this.data.totals[e]=t}addItem(e,t,a){let n,l;return l=this.data.allItems[e].length>0?this.data.allItems[e][this.data.allItems[e].length-1].id+1:0,n={id:l,description:t,value:a},this.data.allItems[e].push(n),n}deleteItem(e,t){var a;-1!==(a=this.data.allItems[e].map((function(e){return e.id})).indexOf(t))&&this.data.allItems[e].splice(a,1)}calculateBudget(){this.calculateTotal("exp"),this.calculateTotal("inc"),this.data.budget=this.data.totals.inc-this.data.totals.exp,this.data.totals.inc>0?this.data.percentage=Math.round(this.data.totals.exp/this.data.totals.inc*100):this.data.percentage=-1}calculatePercentages(){for(let e=0;e<this.data.allItems.exp.length;e++)this.calcPercentage(this.data.totals.inc,parseInt(this.data.allItems.exp[e].value),e)}getPercentages(){return this.data.allItems.exp.map(((e,t)=>this.getPercentage(t)))}getBudget(){return{budget:this.data.budget,totalInc:this.data.totals.inc,totalExp:this.data.totals.exp,percentage:this.data.percentage}}},s=()=>{i.calculateBudget();const e=i.getBudget();n(e)},c=()=>{let n,l;n={type:document.querySelector(e.inputType).value,description:document.querySelector(e.inputDescription).value,value:parseFloat(document.querySelector(e.inputValue).value)},""!==n.description&&!isNaN(n.value)&&n.value>0&&(l=i.addItem(n.type,n.description,n.value),((a,n)=>{let l,i;"inc"===n?(i=e.incomeContainer,l=`<div class="item clearfix" id="inc-${a.id}"><div class="item__description">${a.description}</div><div class="right clearfix"><div class="item__value">${t(a.value,n)}</div><div class="item__delete"><button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button></div></div></div>`):"exp"===n&&(i=e.expensesContainer,l=`<div class="item clearfix" id="exp-${a.id}"><div class="item__description">${a.description}</div><div class="right clearfix"><div class="item__value">${t(a.value,n)}</div><div class="item__percentage">21%</div><div class="item__delete"><button class="item__delete--btn"><i  class="ion-ios-close-outline"></i></button></div></div></div>`),document.querySelector(i).insertAdjacentHTML("beforeend",l)})(l,n.type),(()=>{let t,a;t=document.querySelectorAll(e.inputDescription+", "+e.inputValue),a=Array.prototype.slice.call(t),a.forEach((function(e,t,a){e.value=""})),a[0].focus()})(),s(),i.calculatePercentages(),(t=>{let n=document.querySelectorAll(e.expensesPercentageLabel);a(n,(function(e,a){t[a]>0?e.textContent=`${t[a]}%`:e.textContent="---"}))})(i.getPercentages()))},d=e=>{let t,a,n;if(t=e.target.parentNode.parentNode.parentNode.parentNode.id,t){const e=t.split("-");a=e[0],n=parseInt(e[1]),i.deleteItem(a,n),(e=>{const t=document.getElementById(e);t.parentNode.removeChild(t)})(t),s()}};console.log("Application has started"),(()=>{let t,a,n,l;t=new Date,l=["January","February","March","April","May","June","July","August","September","October","November","December"],n=t.getMonth(),a=t.getFullYear(),document.querySelector(e.dateLabel).textContent=`${l[n]} ${a}`})(),n({budget:0,totalInc:0,totalExp:0,percentage:-1}),(()=>{let t=e;document.querySelector(t.inputBtn).addEventListener("click",c),document.addEventListener("keypress",(function(e){13!==e.keycode&&13!==e.which||c()})),document.querySelector(t.container).addEventListener("click",d),document.querySelector(t.inputType).addEventListener("change",l)})()})();